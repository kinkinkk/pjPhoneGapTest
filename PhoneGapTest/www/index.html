<!DOCTYPE html>
<html>
<head>
<title>テストタイトル</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;" />
<meta charset="utf-8" />

<script type="text/javascript" charset="utf-8" src="plugins/cordova-1.8.0.js"></script>
<script type="text/javascript" charset="utf-8" src="plugins/jquery-1.7.2.min.js"></script>
<script type="text/javascript">
<!--

	// bodyのオンロード時
	$(document).ready(function() 
	{
		const DB_NAME = "DEMO"
	
		// DBObject
		var objDB = window.openDatabase("Database", "1.0", "PhoneGap Demo", 200000);
		
		document.addEventListener("deviceready", function()
		{
			// DB接続
			
			if (objDB) 
			{
				// データベースの作成 
				tranQeury('CREATE TABLE IF NOT EXISTS $DB (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL, data not null)');
			
			}
			else
			{
				alert("データベースストレージが使えません。");
			}
		});
		

		// テーブル参照
		$('#sel_table').click(function()
		{
			tranQeury('SELECT * FROM $DB', function(tx, results)
			{
				$('#disp_table').empty();
				
				for (var i=0; i < results.rows.length; i++)
				{
					$('#disp_table').append(
						"|" + results.rows.item(i).id + 
						"|" + results.rows.item(i).data + "<br />");
				}
				// select文によって返される行数
				alert(results.rows.length + "行が見つかりました。");
				
			});
		});
		
		
		// テーブル追加
		$('#ins_table').click(function()
		{
			tranQeury('INSERT INTO $DB (data) VALUES ("' + $('#target_text').val() + '")');
		});		
		
		// テーブル削除
		$('#del_table').click(function()
		{
			tranQeury('DELETE FROM $DB WHERE data = "' + $('#target_text').val() + '"');

		});
		
		// SQL実行
		function tranQeury(sql, endedMethod)
		{
		
			objDB.transaction(
				// SQLを実行
				function(tx)
				{
					sql = sql.replace(/\$DB/g, DB_NAME); 
					
					if (endedMethod != null)
					{
						tx.executeSql(sql, [], endedMethod);
					}
					else
					{
						tx.executeSql(sql);
					}
					
				}, 
				
				// 異常時
				function (err)
				{
					console.log(err);
					alert("エラーが発生しました。");
				}, 
				// 成功時
				function ()
				{
					//alert("成功しました。");
				}
			);
		}
		
	});    
-->
</script>
</head>
<body>

	<center>
    <h1>(´Д`)</h1>
    </center>
	
    <form>
        テキスト:<input type='text' id='target_text' /><br />
        <input type='button' value='表示' id='sel_table'/> 
        <input type='button' value='追加' id='ins_table'/> 
        <input type='button' value='削除' id='del_table'/>
    </form>
	<div id='disp_table'></div>
	
	<br />
  </body>
</html>
